---
title: "CS6313.002 Statistical Project 1"
author: Ruolan Zeng(rxz171630), Vineet Vilas Amonkar(vva180000), Aakash Kamlesh Punjabi(
  akp170430)
date: "October 24, 2018"
output: html_document
---
## Alternate method

Loading the token data:


```{r}
tokenData <- read.delim("networkstorjTX.txt", header = FALSE, sep = " ")
tokenFrame<- as.data.frame(tokenData)
colnames(tokenFrame)<-c('fromNode','toNode','unixTime','totalAmount')
head(tokenFrame)
```

Removing Outliers from the token data:


```{r}
TotalSupply <- 424999998
Decimals <- 10^8
OutlierValue <- TotalSupply*Decimals
WithoutOutlierdata <- tokenFrame[ which(tokenFrame$totalAmount < OutlierValue),]
head(WithoutOutlierdata)


```

Summary of the token data without outlier:

```{r}
summary(WithoutOutlierdata$totalAmount)

```

Max amount of the token data without outlier:

```{r}
max(WithoutOutlierdata$totalAmount)
```

First step: Ensure that the Storj token data is within the time frame of the Price Data

Following is the date interval of the price data:

Start Date: 07/02/2017
End Date: 07/15/2018

Lets check the date range for the token data

First convert the Unix time of the token data to Date format

```{r}
newwithoutoutlierdata <- WithoutOutlierdata
newwithoutoutlierdata$unixTime <- as.Date(as.POSIXct(WithoutOutlierdata$unixTime,origin="1970-01-01",tz="GMT"))
class(newwithoutoutlierdata$unixTime)


```

loading the price data :
```{r}
priceData <- read.delim("storj", header = TRUE, sep = "\t")
head(priceData)
priceData$Date <- as.Date(priceData$Date, "%m/%d/%Y")
nrow(priceData)
```
add the price return to the dataframe:

```{r}

priceData$Open[1]
(priceData$Open[2]-priceData$Open[1])/priceData$Open[1]


```
create the price return column:
```{r}
return <- numeric(nrow(priceData))
return[379] <- priceData$Open[379]
for (i in 378:1) {
  return[i] <- (priceData$Open[i]-priceData$Open[i+1])/priceData$Open[i+1]
}
return[2]
return
```
adding the price return column to the pricedata dataframe
```{r}
priceData$return <- return
priceData$return[378]
head(newwithoutoutlierdata$Date)
colnames(newwithoutoutlierdata)<-c('fromNode','toNode','Date','totalAmount')
newwithoutoutlierdata$Date[4]
class(priceData$Date)
```
merge both the dataframes according to dates
```{r}
newdataset <- merge(newwithoutoutlierdata,priceData,by = "Date")
head(newdataset$Date)
```


Creating  a feature of no of transactions from the data for doing simple linear regression.

```{r}
frequencytrans <- table(newdataset$Date)
freqtrans<- as.data.frame(frequencytrans)
colnames(freqtrans) <- c("Date","no_of_trans")
freqtrans$Date <- as.Date(freqtrans$Date)
```
mergeing 
 freq trans with newdataset
 
```{r}
simpletable <- merge(priceData,freqtrans,by = "Date")
head(simpletable$Date)
newsimpletable$no_of_trans <- simpletable$no_of_trans
newsimpletable$return<-simpletable$return
newsimpletable<- newsimpletable[,-1]
head(newsimpletable)
```
Data Preparation:

```{r}
summary(newsimpletable)
hist(newsimpletable$no_of_trans)
hist(newsimpletable$return)
```

Analysis:

```{r}
par(mfrow = c(1,1))
bx = boxplot(newsimpletable$no_of_trans,ylim = c(0,5000))
```
checking the distribution of no of transactions:

```{r}
quantile(newsimpletable$no_of_trans, seq(0,1,0.02))
```
boxplot stats:
```{r}
bx$stats
```
```{r}
summary(newsimpletable$no_of_trans)
```
capping at 96%

```{r}
newsimpletable$no_of_trans<-ifelse(newsimpletable$no_of_trans>2000,1500,newsimpletable$no_of_trans)
boxplot(newsimpletable$no_of_trans)
```
checking the response variable:

```{r}
boxplot(newsimpletable$return)
```
bivariate analysis:

```{r}

plot(newsimpletable$no_of_trans,newsimpletable$return)

```

lets check the correlation:

```{r}
cor(newsimpletable)
```

fitting the linear model:

```{r}
library(fmsb)
final_data <- lm(return~no_of_trans,data=newsimpletable)
VIF(final_data)
summary(final_data)
library(lmtest)
par(mfrow = c(2,2))
plot(final_data)
```

